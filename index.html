<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grade Wellbeing Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0F1117;
    --surface: #181C26;
    --surface2: #1E2333;
    --border: rgba(255,255,255,0.07);
    --text: #F0F2F8;
    --text-mid: #8B92A8;
    --text-dim: #4A5068;
    --gold: #F5C842;
    --emotional: #FF7A5C;
    --behavioral: #5CB8FF;
    --physical: #52D9A0;
    --academic: #C17EFF;
    --nutritional: #FFB840;
    --digital: #FF6B9D;
    --safety: #40D4D4;
    --red: #FF5C5C;
    --green: #52D9A0;
    --yellow: #FFB840;
    --radius: 20px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    font-family: 'DM Sans', sans-serif;
    color: var(--text);
    min-height: 100vh;
  }

  /* â”€â”€ LAYOUT â”€â”€ */
  .shell {
    display: flex;
    min-height: 100vh;
  }

  /* â”€â”€ SIDEBAR â”€â”€ */
  .sidebar {
    width: 240px;
    flex-shrink: 0;
    background: var(--surface);
    border-right: 1px solid var(--border);
    padding: 28px 0;
    display: flex;
    flex-direction: column;
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
  }

  .brand {
    padding: 0 24px 28px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 20px;
  }
  .brand-icon { font-size: 22px; margin-bottom: 6px; }
  .brand-name {
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 0.02em;
  }
  .brand-sub { font-size: 11px; color: var(--text-mid); margin-top: 2px; }

  .nav-section {
    padding: 0 12px;
    margin-bottom: 8px;
  }
  .nav-label {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--text-dim);
    padding: 0 12px;
    margin-bottom: 6px;
  }
  .nav-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    border-radius: 10px;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-mid);
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: 2px;
  }
  .nav-item:hover { background: var(--surface2); color: var(--text); }
  .nav-item.active {
    background: rgba(245,200,66,0.12);
    color: var(--gold);
  }
  .nav-item .nav-icon { font-size: 15px; width: 20px; text-align: center; }
  .nav-badge {
    margin-left: auto;
    background: var(--surface2);
    font-size: 10px;
    padding: 2px 7px;
    border-radius: 20px;
    color: var(--text-mid);
  }
  .nav-item.active .nav-badge { background: rgba(245,200,66,0.2); color: var(--gold); }

  .sidebar-footer {
    margin-top: auto;
    padding: 20px 24px 0;
    border-top: 1px solid var(--border);
    font-size: 11px;
    color: var(--text-dim);
    line-height: 1.6;
  }

  /* â”€â”€ MAIN â”€â”€ */
  .main {
    flex: 1;
    overflow-x: hidden;
    padding: 36px 36px 80px;
  }

  /* â”€â”€ TOP BAR â”€â”€ */
  .topbar {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 24px;
    margin-bottom: 36px;
    flex-wrap: wrap;
  }
  .page-title {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 800;
    line-height: 1.2;
  }
  .page-title span { color: var(--gold); }
  .page-sub { font-size: 13px; color: var(--text-mid); margin-top: 6px; }

  .topbar-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .grade-selector {
    display: flex;
    gap: 6px;
  }
  .grade-btn {
    padding: 7px 14px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--text-mid);
    font-size: 12px;
    font-weight: 600;
    font-family: 'DM Sans', sans-serif;
    cursor: pointer;
    transition: all 0.2s;
  }
  .grade-btn.active {
    background: var(--gold);
    color: #0F1117;
    border-color: var(--gold);
  }
  .grade-btn:hover:not(.active) { border-color: rgba(255,255,255,0.2); color: var(--text); }

  .export-btn {
    padding: 8px 18px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--surface2);
    color: var(--text);
    font-size: 12px;
    font-weight: 600;
    font-family: 'DM Sans', sans-serif;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s;
  }
  .export-btn:hover { border-color: rgba(255,255,255,0.2); }

  /* â”€â”€ KPI ROW â”€â”€ */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
    margin-bottom: 24px;
  }
  .kpi-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 22px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.2s;
  }
  .kpi-card:hover { border-color: rgba(255,255,255,0.15); }
  .kpi-label {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text-mid);
    margin-bottom: 10px;
  }
  .kpi-value {
    font-family: 'Syne', sans-serif;
    font-size: 34px;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 6px;
  }
  .kpi-sub { font-size: 12px; color: var(--text-mid); }
  .kpi-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 6px;
    margin-top: 8px;
  }
  .chip-up { background: rgba(82,217,160,0.15); color: var(--green); }
  .chip-down { background: rgba(255,92,92,0.15); color: var(--red); }
  .chip-neutral { background: rgba(139,146,168,0.15); color: var(--text-mid); }
  .kpi-accent {
    position: absolute;
    right: -10px; bottom: -10px;
    font-size: 52px;
    opacity: 0.08;
  }

  /* â”€â”€ GRID 2-COL â”€â”€ */
  .grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }
  .grid-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }

  /* â”€â”€ CARD â”€â”€ */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
  }
  .card-title {
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  .card-sub {
    font-size: 12px;
    color: var(--text-mid);
    margin-bottom: 24px;
  }

  /* â”€â”€ PARAM BARS â”€â”€ */
  .param-list { display: flex; flex-direction: column; gap: 14px; }
  .param-row {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .param-row-icon { font-size: 16px; width: 22px; flex-shrink: 0; }
  .param-row-name { font-size: 13px; font-weight: 500; width: 100px; flex-shrink: 0; }
  .param-row-bar-wrap {
    flex: 1;
    height: 8px;
    background: var(--surface2);
    border-radius: 4px;
    overflow: hidden;
    position: relative;
  }
  .param-row-bar {
    height: 100%;
    border-radius: 4px;
    width: 0;
    transition: width 1.2s cubic-bezier(0.4,0,0.2,1);
  }
  .param-row-score {
    font-size: 13px;
    font-weight: 600;
    width: 34px;
    text-align: right;
    flex-shrink: 0;
  }
  .param-row-delta {
    font-size: 11px;
    width: 36px;
    text-align: right;
    flex-shrink: 0;
  }
  .delta-up { color: var(--green); }
  .delta-down { color: var(--red); }

  /* â”€â”€ DISTRIBUTION CHART â”€â”€ */
  .dist-chart { display: flex; flex-direction: column; gap: 10px; }
  .dist-row { display: flex; align-items: center; gap: 10px; }
  .dist-label { font-size: 12px; color: var(--text-mid); width: 80px; flex-shrink: 0; }
  .dist-bar-track {
    flex: 1;
    height: 24px;
    background: var(--surface2);
    border-radius: 6px;
    overflow: hidden;
    display: flex;
  }
  .dist-seg {
    height: 100%;
    transition: width 1s ease;
    width: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 700;
    color: rgba(0,0,0,0.5);
    overflow: hidden;
    white-space: nowrap;
  }
  .dist-count { font-size: 12px; color: var(--text-mid); width: 30px; text-align: right; }

  /* â”€â”€ HEATMAP â”€â”€ */
  .heatmap-wrap { overflow-x: auto; }
  .heatmap {
    display: grid;
    gap: 4px;
    min-width: 400px;
  }
  .heatmap-header {
    display: grid;
    gap: 4px;
    margin-bottom: 4px;
  }
  .hm-label {
    font-size: 10px;
    color: var(--text-mid);
    font-weight: 600;
    text-align: center;
    padding: 4px 2px;
    letter-spacing: 0.05em;
  }
  .hm-row {
    display: grid;
    gap: 4px;
    align-items: center;
  }
  .hm-cell {
    height: 32px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.15s, opacity 0.15s;
    position: relative;
  }
  .hm-cell:hover { transform: scale(1.08); opacity: 0.9; z-index: 10; }
  .hm-row-label {
    font-size: 11px;
    color: var(--text-mid);
    font-weight: 500;
    text-align: right;
    padding-right: 8px;
  }

  /* â”€â”€ CONCERN TABLE â”€â”€ */
  .concern-table { width: 100%; border-collapse: collapse; }
  .concern-table th {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-dim);
    text-align: left;
    padding: 0 0 14px;
    border-bottom: 1px solid var(--border);
  }
  .concern-table td {
    padding: 12px 0;
    font-size: 13px;
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
  }
  .concern-table tr:last-child td { border-bottom: none; }
  .student-tag {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    background: var(--surface2);
  }
  .student-dot { width: 6px; height: 6px; border-radius: 50%; }
  .alert-pill {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 8px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 600;
  }
  .alert-high { background: rgba(255,92,92,0.15); color: var(--red); }
  .alert-med { background: rgba(255,184,64,0.15); color: var(--yellow); }
  .concern-params { display: flex; gap: 6px; flex-wrap: wrap; }
  .concern-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 4px;
  }

  /* â”€â”€ QUADRANT â”€â”€ */
  .quadrant-wrap {
    position: relative;
    height: 300px;
  }
  .quadrant-svg { width: 100%; height: 100%; }
  .q-dot {
    cursor: pointer;
    transition: r 0.2s;
  }
  .q-dot:hover { filter: brightness(1.3); }

  /* â”€â”€ TABS â”€â”€ */
  .tabs { display: flex; gap: 4px; margin-bottom: 24px; }
  .tab {
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    color: var(--text-mid);
    transition: all 0.2s;
    border: 1px solid transparent;
  }
  .tab.active {
    background: var(--surface2);
    color: var(--text);
    border-color: var(--border);
  }
  .tab:hover:not(.active) { color: var(--text); }

  /* â”€â”€ RADAR â”€â”€ */
  .radar-wrap { display: flex; align-items: center; justify-content: center; }

  /* â”€â”€ LEGEND ROW â”€â”€ */
  .legend-row {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border);
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--text-mid);
  }
  .legend-swatch {
    width: 10px; height: 10px;
    border-radius: 2px;
  }

  /* â”€â”€ INSIGHT CHIPS â”€â”€ */
  .insights-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }
  .insight-chip {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: var(--surface);
    font-size: 13px;
    cursor: default;
  }
  .insight-chip .ic-icon { font-size: 16px; }
  .insight-chip .ic-text { color: var(--text-mid); }
  .insight-chip .ic-text strong { color: var(--text); font-weight: 600; }

  /* â”€â”€ TOOLTIP â”€â”€ */
  #tooltip {
    position: fixed;
    background: #2A3048;
    border: 1px solid var(--border);
    color: var(--text);
    padding: 8px 14px;
    border-radius: 10px;
    font-size: 12px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
    max-width: 200px;
    line-height: 1.5;
  }

  /* â”€â”€ ANIMATIONS â”€â”€ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-in { animation: fadeUp 0.5s ease both; }

  /* â”€â”€ SCROLLBAR â”€â”€ */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 900px) {
    .sidebar { display: none; }
    .kpi-row { grid-template-columns: 1fr 1fr; }
    .grid-2, .grid-3 { grid-template-columns: 1fr; }
  }
  @media (max-width: 600px) {
    .main { padding: 20px; }
    .kpi-row { grid-template-columns: 1fr; }
  }

  .span-2 { grid-column: span 2; }
  .span-3 { grid-column: span 3; }

  /* Full width grid */
  .grid-full { margin-bottom: 20px; }
</style>
</head>
<body>
<div id="tooltip"></div>

<div class="shell">

  <!-- â”€â”€ SIDEBAR â”€â”€ -->
  <nav class="sidebar">
    <div class="brand">
      <div class="brand-icon">ğŸŒ±</div>
      <div class="brand-name">WellBeing Analytics</div>
      <div class="brand-sub">Annual Evaluation 2024â€“25</div>
    </div>

    <div class="nav-item">
  <a href="./schoolView.html" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;width:100%;">
    <span class="nav-icon">ğŸ«</span> 
    School View
    <span class="nav-badge">1</span>
  </a>
</div>

<div class="nav-item active">
  <span class="nav-icon">ğŸ“‹</span> 
  Grade View
  <span class="nav-badge">6</span>
</div>

<div class="nav-item">
  <a href="./individual.html" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;width:100%;">
    <span class="nav-icon">ğŸ‘¤</span> 
    Individual
    <span class="nav-badge">50</span>
  </a>
</div>


    <div class="nav-section" style="margin-top:16px;">
      <div class="nav-label">Parameters</div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ’›</span> Emotional
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ¤</span> Behavioral
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸƒ</span> Physical
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ“š</span> Academic
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ¥—</span> Nutritional
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ“±</span> Digital
      </div>
      <div class="nav-item" style="font-size:12px;">
        <span class="nav-icon">ğŸ›¡ï¸</span> Safety & Env.
      </div>
    </div>

    <div class="sidebar-footer">
      Evaluations submitted<br>
      <strong style="color:var(--text-mid)">50 / 50 students</strong><br>
      Response rate: 100%
    </div>
  </nav>

  <!-- â”€â”€ MAIN â”€â”€ -->
  <main class="main">

    <!-- Top Bar -->
    <div class="topbar fade-in">
      <div>
        <div class="page-title">Grade <span>7</span> Wellbeing<br>Dashboard</div>
        <div class="page-sub">50 students &nbsp;Â·&nbsp; Evaluation Period: Janâ€“Feb 2025 &nbsp;Â·&nbsp; Class Teacher: Ms. Priya Mehta</div>
      </div>
      <div class="topbar-actions">
        <div class="grade-selector">
          <button class="grade-btn">Gr 5</button>
          <button class="grade-btn">Gr 6</button>
          <button class="grade-btn active">Gr 7</button>
          <button class="grade-btn">Gr 8</button>
          <button class="grade-btn">Gr 9</button>
        </div>
        <button class="export-btn">â¬‡ Export PDF</button>
      </div>
    </div>

    <!-- Quick Insight Chips -->
    <div class="insights-row fade-in">
      <div class="insight-chip">
        <span class="ic-icon">âš ï¸</span>
        <span class="ic-text"><strong>8 students</strong> flagged for counselor review</span>
      </div>
      <div class="insight-chip">
        <span class="ic-icon">ğŸ“±</span>
        <span class="ic-text"><strong>Digital Wellbeing</strong> is the lowest-scoring parameter</span>
      </div>
      <div class="insight-chip">
        <span class="ic-icon">ğŸ›¡ï¸</span>
        <span class="ic-text"><strong>Safety</strong> is the strongest area across the grade</span>
      </div>
      <div class="insight-chip">
        <span class="ic-icon">ğŸ“ˆ</span>
        <span class="ic-text">Grade avg improved <strong>+4.2 pts</strong> vs last year</span>
      </div>
    </div>

    <!-- KPI Row -->
    <div class="kpi-row fade-in">
      <div class="kpi-card">
        <div class="kpi-label">Grade Wellbeing Index</div>
        <div class="kpi-value" style="color:var(--gold)" id="kpiGrade">â€”</div>
        <div class="kpi-sub">Average across 7 params</div>
        <div class="kpi-chip chip-up">â–² +4.2 vs last year</div>
        <div class="kpi-accent">ğŸŒŸ</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">Students Thriving</div>
        <div class="kpi-value" style="color:var(--green)">24</div>
        <div class="kpi-sub">Score â‰¥ 75 across all params</div>
        <div class="kpi-chip chip-up">â–² 48% of grade</div>
        <div class="kpi-accent">âœ…</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">Need Attention</div>
        <div class="kpi-value" style="color:var(--yellow)">18</div>
        <div class="kpi-sub">1â€“2 parameters below 60</div>
        <div class="kpi-chip chip-neutral">36% of grade</div>
        <div class="kpi-accent">âš¡</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">High Concern</div>
        <div class="kpi-value" style="color:var(--red)">8</div>
        <div class="kpi-sub">3+ parameters below 55</div>
        <div class="kpi-chip chip-down">â–¼ Priority review needed</div>
        <div class="kpi-accent">ğŸš¨</div>
      </div>
    </div>

    <!-- Row: Parameter scores + Radar -->
    <div class="grid-2 fade-in">
      <!-- Parameter Bar Chart -->
      <div class="card">
        <div class="card-title">Parameter-wise Grade Averages</div>
        <div class="card-sub">Score out of 100 Â· Compared to school avg</div>
        <div class="param-list" id="paramBars"></div>
        <div class="legend-row">
          <div class="legend-item"><div class="legend-swatch" style="background:var(--gold)"></div> Grade 7</div>
          <div class="legend-item"><div class="legend-swatch" style="background:var(--surface2);border:1px solid var(--border)"></div> School Avg</div>
        </div>
      </div>

      <!-- Radar -->
      <div class="card">
        <div class="card-title">Wellbeing Radar</div>
        <div class="card-sub">Grade 7 profile vs school average</div>
        <div class="radar-wrap">
          <svg id="radarSvg" width="280" height="280" viewBox="0 0 280 280" style="overflow:visible"></svg>
        </div>
      </div>
    </div>

    <!-- Row: Distribution + Heatmap -->
    <div class="grid-2 fade-in">
      <!-- Score Distribution -->
      <div class="card">
        <div class="card-title">Score Distribution by Parameter</div>
        <div class="card-sub">How students are spread across ranges</div>
        <div class="dist-chart" id="distChart"></div>
        <div class="legend-row">
          <div class="legend-item"><div class="legend-swatch" style="background:var(--green)"></div> Strong (75â€“100)</div>
          <div class="legend-item"><div class="legend-swatch" style="background:var(--yellow)"></div> Moderate (55â€“74)</div>
          <div class="legend-item"><div class="legend-swatch" style="background:var(--red)"></div> Concern (&lt;55)</div>
        </div>
      </div>

      <!-- Flagged Students -->
      <div class="card">
        <div class="card-title">ğŸš¨ Priority Student Flags</div>
        <div class="card-sub">Students requiring counselor attention</div>
        <table class="concern-table" id="concernTable"></table>
      </div>
    </div>

    <!-- Full width: Heatmap -->
    <div class="card grid-full fade-in">
      <div class="card-title">Student Ã— Parameter Heatmap</div>
      <div class="card-sub">Each row = one student Â· Hover for score details Â· Sorted by overall score</div>
      <div class="tabs">
        <div class="tab active" onclick="setHeatSort('overall', this)">Sort by Overall</div>
        <div class="tab" onclick="setHeatSort('emotional', this)">Emotional</div>
        <div class="tab" onclick="setHeatSort('digital', this)">Digital</div>
        <div class="tab" onclick="setHeatSort('academic', this)">Academic</div>
      </div>
      <div class="heatmap-wrap">
        <div id="heatmapContainer"></div>
      </div>
    </div>

    <!-- Grade Recommendations -->
    <div class="card fade-in" style="margin-bottom:20px;">
      <div class="card-title">ğŸ“‹ Grade-Level Recommendations</div>
      <div class="card-sub">Targeted interventions based on grade-wide patterns</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:4px;" id="recoGrid"></div>
    </div>

  </main>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA LAYER â€” Replace with real backend data
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PARAMS = [
  { id: 'emotional',   name: 'Emotional',   icon: 'ğŸ’›', color: '#F5A623', shortColor: 'var(--emotional)' },
  { id: 'behavioral',  name: 'Behavioral',  icon: 'ğŸ¤', color: '#5CB8FF', shortColor: 'var(--behavioral)' },
  { id: 'physical',    name: 'Physical',    icon: 'ğŸƒ', color: '#52D9A0', shortColor: 'var(--physical)' },
  { id: 'academic',    name: 'Academic',    icon: 'ğŸ“š', color: '#C17EFF', shortColor: 'var(--academic)' },
  { id: 'nutritional', name: 'Nutritional', icon: 'ğŸ¥—', color: '#FFB840', shortColor: 'var(--nutritional)' },
  { id: 'digital',     name: 'Digital',     icon: 'ğŸ“±', color: '#FF6B9D', shortColor: 'var(--digital)' },
  { id: 'safety',      name: 'Safety',      icon: 'ğŸ›¡ï¸', color: '#40D4D4', shortColor: 'var(--safety)' },
];

// Grade 7 averages + school benchmark
const GRADE_SCORES = {
  emotional:   { grade: 68, school: 72 },
  behavioral:  { grade: 74, school: 70 },
  physical:    { grade: 63, school: 66 },
  academic:    { grade: 71, school: 68 },
  nutritional: { grade: 58, school: 61 },
  digital:     { grade: 44, school: 48 },
  safety:      { grade: 82, school: 79 },
};

// Distribution: [strong, moderate, concern] count out of 50
const DISTRIBUTION = {
  emotional:   [28, 14, 8],
  behavioral:  [32, 12, 6],
  physical:    [22, 18, 10],
  academic:    [26, 18, 6],
  nutritional: [18, 20, 12],
  digital:     [10, 22, 18],
  safety:      [38, 8, 4],
};

// Generate 50 students
function genStudents() {
  const names = ['Aarav','Aditi','Arjun','Ananya','Aryan','Bhavya','Dev','Diya','Ishaan','Isha',
    'Kabir','Kavya','Kiara','Krishna','Lakshmi','Manav','Meera','Neel','Nisha','Om',
    'Priya','Rahul','Riya','Rohan','Saanvi','Sai','Shiv','Shreya','Siddharth','Sneha',
    'Tanvi','Uday','Uma','Veer','Vidya','Vikram','Yash','Zara','Akash','Anika',
    'Chirag','Deepa','Farhan','Gauri','Harsh','Jiya','Karan','Lara','Mihir','Naina'];
  return names.map((name, i) => {
    const scores = {};
    PARAMS.forEach(p => {
      // Skew digital lower, safety higher
      let base = p.id === 'digital' ? 44 : p.id === 'safety' ? 82 : GRADE_SCORES[p.id].grade;
      scores[p.id] = Math.min(100, Math.max(20, Math.round(base + (Math.random() - 0.5) * 36)));
    });
    const overall = Math.round(Object.values(scores).reduce((a, b) => a + b, 0) / 7);
    return { id: i + 1, name, scores, overall };
  });
}

const STUDENTS = genStudents();

const FLAGGED = STUDENTS
  .filter(s => Object.values(s.scores).filter(v => v < 55).length >= 3)
  .slice(0, 8)
  .map(s => ({
    ...s,
    concerns: PARAMS.filter(p => s.scores[p.id] < 55),
    priority: Object.values(s.scores).filter(v => v < 45).length >= 2 ? 'High' : 'Medium'
  }));

const gradeAvg = Math.round(STUDENTS.reduce((s, st) => s + st.overall, 0) / STUDENTS.length);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMPONENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// KPI
document.getElementById('kpiGrade').textContent = gradeAvg;

// â”€â”€ PARAM BARS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildParamBars() {
  const container = document.getElementById('paramBars');
  PARAMS.forEach(p => {
    const data = GRADE_SCORES[p.id];
    const delta = data.grade - data.school;
    const deltaStr = (delta >= 0 ? '+' : '') + delta;
    const deltaClass = delta >= 0 ? 'delta-up' : 'delta-down';
    const row = document.createElement('div');
    row.className = 'param-row';
    row.innerHTML = `
      <div class="param-row-icon">${p.icon}</div>
      <div class="param-row-name">${p.name}</div>
      <div class="param-row-bar-wrap">
        <div class="param-row-bar" data-w="${data.grade}" style="background:${p.color};width:0%"></div>
      </div>
      <div class="param-row-score">${data.grade}</div>
      <div class="param-row-delta ${deltaClass}">${deltaStr}</div>
    `;
    container.appendChild(row);
  });
  setTimeout(() => {
    document.querySelectorAll('.param-row-bar').forEach(b => {
      b.style.width = b.dataset.w + '%';
    });
  }, 400);
}

// â”€â”€ RADAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawRadar() {
  const svg = document.getElementById('radarSvg');
  const NS = 'http://www.w3.org/2000/svg';
  const cx = 140, cy = 140, r = 110, n = PARAMS.length, levels = 4;

  // Grid
  for (let l = 1; l <= levels; l++) {
    const pts = PARAMS.map((_, i) => {
      const a = (i / n) * 2 * Math.PI - Math.PI / 2;
      const rad = (l / levels) * r;
      return `${cx + rad * Math.cos(a)},${cy + rad * Math.sin(a)}`;
    }).join(' ');
    const poly = document.createElementNS(NS, 'polygon');
    poly.setAttribute('points', pts);
    poly.setAttribute('fill', 'none');
    poly.setAttribute('stroke', 'rgba(255,255,255,0.08)');
    poly.setAttribute('stroke-width', '1');
    svg.appendChild(poly);
  }

  // Axes
  PARAMS.forEach((p, i) => {
    const a = (i / n) * 2 * Math.PI - Math.PI / 2;
    const line = document.createElementNS(NS, 'line');
    line.setAttribute('x1', cx); line.setAttribute('y1', cy);
    line.setAttribute('x2', cx + r * Math.cos(a));
    line.setAttribute('y2', cy + r * Math.sin(a));
    line.setAttribute('stroke', 'rgba(255,255,255,0.1)');
    line.setAttribute('stroke-width', '1');
    svg.appendChild(line);

    const lx = cx + (r + 20) * Math.cos(a);
    const ly = cy + (r + 20) * Math.sin(a);
    const text = document.createElementNS(NS, 'text');
    text.setAttribute('x', lx); text.setAttribute('y', ly);
    text.setAttribute('text-anchor', 'middle');
    text.setAttribute('dominant-baseline', 'middle');
    text.setAttribute('font-size', '11');
    text.setAttribute('font-family', 'DM Sans, sans-serif');
    text.setAttribute('fill', p.color);
    text.setAttribute('font-weight', '600');
    text.textContent = p.icon;
    svg.appendChild(text);
  });

  // School avg polygon
  const schoolPts = PARAMS.map((p, i) => {
    const a = (i / n) * 2 * Math.PI - Math.PI / 2;
    const rad = (GRADE_SCORES[p.id].school / 100) * r;
    return `${cx + rad * Math.cos(a)},${cy + rad * Math.sin(a)}`;
  }).join(' ');
  const schoolPoly = document.createElementNS(NS, 'polygon');
  schoolPoly.setAttribute('points', schoolPts);
  schoolPoly.setAttribute('fill', 'rgba(255,255,255,0.04)');
  schoolPoly.setAttribute('stroke', 'rgba(255,255,255,0.2)');
  schoolPoly.setAttribute('stroke-width', '1.5');
  schoolPoly.setAttribute('stroke-dasharray', '4 3');
  svg.appendChild(schoolPoly);

  // Grade polygon
  const gradePts = PARAMS.map((p, i) => {
    const a = (i / n) * 2 * Math.PI - Math.PI / 2;
    const rad = (GRADE_SCORES[p.id].grade / 100) * r;
    return `${cx + rad * Math.cos(a)},${cy + rad * Math.sin(a)}`;
  }).join(' ');
  const gradePoly = document.createElementNS(NS, 'polygon');
  gradePoly.setAttribute('points', gradePts);
  gradePoly.setAttribute('fill', 'rgba(245,200,66,0.15)');
  gradePoly.setAttribute('stroke', '#F5C842');
  gradePoly.setAttribute('stroke-width', '2');
  gradePoly.style.opacity = '0';
  gradePoly.style.transition = 'opacity 0.8s ease';
  svg.appendChild(gradePoly);
  setTimeout(() => { gradePoly.style.opacity = 1; }, 500);
}

// â”€â”€ DISTRIBUTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildDist() {
  const container = document.getElementById('distChart');
  PARAMS.forEach(p => {
    const [strong, mod, concern] = DISTRIBUTION[p.id];
    const total = 50;
    const row = document.createElement('div');
    row.className = 'dist-row';
    row.innerHTML = `
      <div class="dist-label">${p.icon} ${p.name}</div>
      <div class="dist-bar-track">
        <div class="dist-seg" data-w="${(strong/total)*100}" style="background:#52D9A0;color:#0F1117">${strong}</div>
        <div class="dist-seg" data-w="${(mod/total)*100}" style="background:#FFB840;color:#0F1117">${mod}</div>
        <div class="dist-seg" data-w="${(concern/total)*100}" style="background:#FF5C5C;color:white">${concern}</div>
      </div>
      <div class="dist-count">${total}</div>
    `;
    container.appendChild(row);
  });
  setTimeout(() => {
    document.querySelectorAll('.dist-seg').forEach(seg => {
      seg.style.width = seg.dataset.w + '%';
    });
  }, 500);
}

// â”€â”€ CONCERN TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildConcernTable() {
  const table = document.getElementById('concernTable');
  table.innerHTML = `
    <thead>
      <tr>
        <th>Student</th>
        <th>Priority</th>
        <th>Weak Parameters</th>
        <th>Overall</th>
      </tr>
    </thead>
  `;
  const tbody = document.createElement('tbody');
  FLAGGED.slice(0, 6).forEach(s => {
    const tr = document.createElement('tr');
    const concernDots = s.concerns.map(c =>
      `<span title="${c.name}: ${s.scores[c.id]}" style="display:inline-flex;align-items:center;gap:3px;font-size:11px;padding:2px 6px;border-radius:4px;background:rgba(255,92,92,0.12);color:var(--red);margin:2px;">
        ${c.icon} ${c.name} <span style="opacity:0.7">${s.scores[c.id]}</span>
      </span>`
    ).join('');
    const priorityHtml = s.priority === 'High'
      ? `<span class="alert-pill alert-high">ğŸ”´ High</span>`
      : `<span class="alert-pill alert-med">ğŸŸ¡ Medium</span>`;
    tr.innerHTML = `
      <td><div class="student-tag"><span class="student-dot" style="background:#F5C842"></span>${s.name}</div></td>
      <td>${priorityHtml}</td>
      <td><div class="concern-params">${concernDots}</div></td>
      <td style="font-weight:600;color:var(--red)">${s.overall}</td>
    `;
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);
}

// â”€â”€ HEATMAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentSort = 'overall';
function buildHeatmap() {
  const sorted = [...STUDENTS].sort((a, b) => b.scores[currentSort] !== undefined ? b.scores[currentSort] - a.scores[currentSort] : b.overall - a.overall);

  const container = document.getElementById('heatmapContainer');
  const cols = 1 + PARAMS.length; // name col + 7 params
  const colDef = `80px ${PARAMS.map(() => '1fr').join(' ')}`;

  let html = `<div style="display:grid;grid-template-columns:${colDef};gap:4px;min-width:520px;">`;
  // Header
  html += `<div class="hm-label" style="text-align:right">Student</div>`;
  PARAMS.forEach(p => {
    html += `<div class="hm-label">${p.icon}<br>${p.name.slice(0,5)}</div>`;
  });

  // Rows (show 20 for performance)
  sorted.slice(0, 25).forEach(s => {
    html += `<div class="hm-row-label">${s.name}</div>`;
    PARAMS.forEach(p => {
      const score = s.scores[p.id];
      const pct = score / 100;
      // Interpolate color from red â†’ yellow â†’ green
      let bg, textColor = '#fff';
      if (score >= 75) { bg = '#52D9A0'; textColor = '#0F1117'; }
      else if (score >= 55) { bg = '#FFB840'; textColor = '#0F1117'; }
      else { bg = '#FF5C5C'; }
      const opacity = 0.4 + pct * 0.6;
      html += `<div class="hm-cell" style="background:${bg};opacity:${opacity};color:${textColor}"
        onmouseenter="showTip(event,'${s.name} Â· ${p.name}: ${score}/100')"
        onmouseleave="hideTip()">${score}</div>`;
    });
  });
  html += `</div>`;
  container.innerHTML = html;
}

function setHeatSort(field, el) {
  currentSort = field;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  buildHeatmap();
}

// â”€â”€ RECOMMENDATIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const RECOS = [
  { emoji: 'ğŸ“±', title: 'Digital Wellness Workshop', text: 'Conduct a parent + student session on healthy screen habits. Grade 7 digital scores are critically low at 44/100.', urgency: 'urgent' },
  { emoji: 'ğŸ¥—', title: 'Nutrition Awareness Program', text: 'Partner with the canteen to offer healthier options. Nutritional scores (58) are the second lowest.', urgency: 'medium' },
  { emoji: 'ğŸƒ', title: 'Daily Movement Breaks', text: '5-minute structured movement breaks between classes can improve physical wellbeing scores (currently 63).', urgency: 'medium' },
  { emoji: 'ğŸ’›', title: 'Emotional Check-in Circles', text: 'Weekly classroom emotional check-ins can support the 8 students scoring below 55 on emotional wellbeing.', urgency: 'medium' },
  { emoji: 'ğŸš¨', title: '1-on-1 Counselor Sessions', text: '8 flagged students need individual counselor attention within the next 2 weeks.', urgency: 'urgent' },
  { emoji: 'ğŸ“š', title: 'Career Conversation Day', text: 'Organize a structured "future me" day â€” many students don\'t know who decides their career goals.', urgency: 'low' },
];

function buildRecos() {
  const grid = document.getElementById('recoGrid');
  const urgencyColors = { urgent: '#FF5C5C', medium: '#FFB840', low: '#52D9A0' };
  const urgencyBg = { urgent: 'rgba(255,92,92,0.1)', medium: 'rgba(255,184,64,0.1)', low: 'rgba(82,217,160,0.1)' };
  RECOS.forEach(r => {
    const el = document.createElement('div');
    el.style.cssText = `padding:16px 18px;border-radius:14px;background:var(--surface2);border-left:3px solid ${urgencyColors[r.urgency]};`;
    el.innerHTML = `
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
        <span style="font-size:18px">${r.emoji}</span>
        <span style="font-size:13px;font-weight:600">${r.title}</span>
        <span style="margin-left:auto;font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;background:${urgencyBg[r.urgency]};color:${urgencyColors[r.urgency]};text-transform:uppercase;letter-spacing:0.08em">${r.urgency}</span>
      </div>
      <div style="font-size:12px;color:var(--text-mid);line-height:1.6">${r.text}</div>
    `;
    grid.appendChild(el);
  });
}

// â”€â”€ TOOLTIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showTip(e, text) {
  const tip = document.getElementById('tooltip');
  tip.textContent = text;
  tip.style.opacity = 1;
  tip.style.left = (e.clientX + 12) + 'px';
  tip.style.top = (e.clientY - 32) + 'px';
}
function hideTip() {
  document.getElementById('tooltip').style.opacity = 0;
}

function setLevel(level) {
  const msgs = {
    school: 'School View would show all grades. Use the nav to drill down.',
    grade: '',
    individual: 'Click any student name in the heatmap or concern table to open individual report.'
  };
  if (msgs[level]) alert(msgs[level]);
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
buildParamBars();
drawRadar();
buildDist();
buildConcernTable();
buildHeatmap();
buildRecos();
</script>
</body>
</html>
