<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>School Wellbeing Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Cabinet+Grotesk:wght@400;500;700;800;900&family=Instrument+Serif:ital@0;1&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --ink: #0A0C10;
  --paper: #F5F3EE;
  --paper2: #EDEAE2;
  --paper3: #E2DED4;
  --rule: rgba(10,12,16,0.1);
  --rule2: rgba(10,12,16,0.06);
  --text: #0A0C10;
  --text-mid: #5A5750;
  --text-dim: #9E9B94;
  --accent: #1A3A2A;
  --accent2: #2D6A4F;
  --gold: #C9931A;
  --red: #C0392B;
  --amber: #D4870A;
  --green: #1E7A4A;
  --blue: #1A4A7A;

  --emotional:   #E8654A;
  --behavioral:  #2E86C1;
  --physical:    #1E8449;
  --academic:    #8E44AD;
  --nutritional: #D4870A;
  --digital:     #C0392B;
  --safety:      #148F77;

  --primary-band:  #2E4A7A;
  --middle-band:   #1A6B45;
  --senior-band:   #7A2E4A;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: var(--paper);
  font-family: 'Cabinet Grotesk', sans-serif;
  color: var(--text);
  min-height: 100vh;
}

/* â”€â”€ TOP MASTHEAD â”€â”€ */
.masthead {
  background: var(--ink);
  color: var(--paper);
  padding: 0;
  border-bottom: 3px solid var(--gold);
}
.masthead-inner {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 40px;
  display: flex;
  align-items: stretch;
  min-height: 80px;
}
.masthead-brand {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px 32px 20px 0;
  border-right: 1px solid rgba(255,255,255,0.12);
  margin-right: 32px;
}
.brand-emblem {
  width: 44px; height: 44px;
  background: var(--gold);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
}
.brand-name-main {
  font-size: 17px;
  font-weight: 900;
  letter-spacing: -0.02em;
  line-height: 1.2;
}
.brand-name-sub {
  font-size: 11px;
  color: rgba(255,255,255,0.5);
  font-weight: 400;
  letter-spacing: 0.05em;
  text-transform: uppercase;
}
.masthead-nav {
  display: flex;
  align-items: center;
  gap: 4px;
  flex: 1;
}
.mnav-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  color: rgba(255,255,255,0.5);
  cursor: pointer;
  transition: all 0.2s;
}
.mnav-item:hover { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.9); }
.mnav-item.active {
  background: rgba(201,147,26,0.2);
  color: var(--gold);
}
.mnav-item .mn-icon { font-size: 14px; }
.masthead-right {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-left: auto;
}
.mhead-btn {
  padding: 8px 18px;
  border-radius: 8px;
  font-family: 'Cabinet Grotesk', sans-serif;
  font-weight: 700;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
}
.mhead-btn-outline {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.2);
  color: rgba(255,255,255,0.7);
}
.mhead-btn-outline:hover { border-color: rgba(255,255,255,0.5); color: white; }
.mhead-btn-fill {
  background: var(--gold);
  border: none;
  color: var(--ink);
}
.mhead-btn-fill:hover { background: #e8a820; }

/* â”€â”€ HERO STRIP â”€â”€ */
.hero-strip {
  background: var(--accent);
  color: white;
  padding: 32px 40px;
  max-width: 100%;
}
.hero-inner {
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 40px;
  flex-wrap: wrap;
}
.hero-left h1 {
  font-family: 'Instrument Serif', serif;
  font-size: clamp(28px, 3vw, 40px);
  font-weight: 400;
  font-style: italic;
  line-height: 1.2;
  margin-bottom: 8px;
}
.hero-left h1 em {
  font-style: normal;
  color: #7FD4A8;
}
.hero-meta {
  font-size: 13px;
  color: rgba(255,255,255,0.55);
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}
.hero-meta span { display: flex; align-items: center; gap: 5px; }
.hero-kpis {
  display: flex;
  gap: 2px;
}
.hero-kpi {
  background: rgba(255,255,255,0.08);
  padding: 16px 24px;
  border-radius: 4px;
  text-align: center;
  min-width: 110px;
}
.hero-kpi:first-child { border-radius: 12px 4px 4px 12px; }
.hero-kpi:last-child { border-radius: 4px 12px 12px 4px; }
.hk-val {
  font-family: 'DM Mono', monospace;
  font-size: 30px;
  font-weight: 500;
  line-height: 1;
  margin-bottom: 4px;
}
.hk-label { font-size: 10px; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600; }

/* â”€â”€ MAIN CONTENT â”€â”€ */
.content-wrap {
  max-width: 1400px;
  margin: 0 auto;
  padding: 36px 40px 80px;
}

/* â”€â”€ SECTION HEADER â”€â”€ */
.section-head {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 20px;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 2px solid var(--rule);
}
.section-title {
  font-size: 13px;
  font-weight: 900;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--text-mid);
}
.section-title span {
  display: block;
  font-family: 'Instrument Serif', serif;
  font-size: 22px;
  font-weight: 400;
  font-style: italic;
  text-transform: none;
  letter-spacing: 0;
  color: var(--text);
  margin-top: 2px;
}
.section-action {
  font-size: 12px;
  color: var(--accent2);
  font-weight: 700;
  cursor: pointer;
  text-decoration: underline;
  text-underline-offset: 3px;
  white-space: nowrap;
}

/* â”€â”€ CARDS â”€â”€ */
.card {
  background: white;
  border: 1px solid var(--rule);
  border-radius: 16px;
  padding: 28px;
}
.card-title {
  font-size: 14px;
  font-weight: 800;
  margin-bottom: 3px;
}
.card-sub {
  font-size: 12px;
  color: var(--text-dim);
  margin-bottom: 20px;
}

/* â”€â”€ GRIDS â”€â”€ */
.g2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 28px; }
.g3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 28px; }
.g4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 28px; }
.gfull { margin-bottom: 28px; }

/* â”€â”€ AGE GROUP BANDS â”€â”€ */
.age-bands {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 28px;
}
.age-band-card {
  border-radius: 16px;
  overflow: hidden;
  border: 1px solid var(--rule);
  background: white;
  transition: transform 0.2s, box-shadow 0.2s;
  cursor: pointer;
}
.age-band-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 40px rgba(10,12,16,0.12);
}
.band-header {
  padding: 20px 24px 16px;
  color: white;
  position: relative;
  overflow: hidden;
}
.band-header::after {
  content: attr(data-emoji);
  position: absolute;
  right: 16px; top: 50%;
  transform: translateY(-50%);
  font-size: 48px;
  opacity: 0.2;
}
.band-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  opacity: 0.7;
  margin-bottom: 4px;
}
.band-name {
  font-size: 20px;
  font-weight: 900;
  margin-bottom: 2px;
}
.band-grades {
  font-size: 12px;
  opacity: 0.7;
}
.band-body { padding: 20px 24px; }
.band-score-row {
  display: flex;
  align-items: baseline;
  gap: 6px;
  margin-bottom: 12px;
}
.band-score {
  font-family: 'DM Mono', monospace;
  font-size: 42px;
  font-weight: 500;
  line-height: 1;
}
.band-score-label { font-size: 12px; color: var(--text-dim); }
.band-delta {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  font-size: 11px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 20px;
  margin-bottom: 16px;
}
.band-params { display: flex; flex-direction: column; gap: 6px; }
.bp-row { display: flex; align-items: center; gap: 8px; }
.bp-name { font-size: 11px; color: var(--text-mid); width: 76px; flex-shrink: 0; }
.bp-track { flex: 1; height: 5px; background: var(--paper2); border-radius: 3px; overflow: hidden; }
.bp-fill { height: 100%; border-radius: 3px; width: 0; transition: width 1.2s cubic-bezier(0.4,0,0.2,1); }
.bp-val { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--text-mid); width: 26px; text-align: right; }

/* â”€â”€ SCHOOL PARAM OVERVIEW â”€â”€ */
.param-overview { display: flex; flex-direction: column; gap: 0; }
.po-row {
  display: grid;
  grid-template-columns: 130px 60px 1fr 60px 60px;
  align-items: center;
  gap: 16px;
  padding: 14px 0;
  border-bottom: 1px solid var(--rule2);
  transition: background 0.15s;
}
.po-row:last-child { border-bottom: none; }
.po-row:hover { background: var(--paper2); margin: 0 -12px; padding-left: 12px; padding-right: 12px; border-radius: 8px; }
.po-icon-name { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 700; }
.po-icon { font-size: 18px; }
.po-score {
  font-family: 'DM Mono', monospace;
  font-size: 22px;
  font-weight: 500;
  text-align: center;
}
.po-bar-track {
  height: 10px;
  background: var(--paper2);
  border-radius: 5px;
  overflow: hidden;
}
.po-bar {
  height: 100%;
  border-radius: 5px;
  width: 0;
  transition: width 1.3s cubic-bezier(0.4,0,0.2,1);
  position: relative;
}
.po-bar::after {
  content: attr(data-school);
  position: absolute;
  right: -1px; top: 50%;
  transform: translateY(-50%);
  width: 2px; height: 16px;
  background: rgba(10,12,16,0.3);
  border-radius: 1px;
}
.po-students { font-size: 11px; color: var(--text-dim); text-align: center; }
.po-trend { font-size: 12px; font-weight: 700; text-align: center; }
.trend-up { color: var(--green); }
.trend-dn { color: var(--red); }
.trend-flat { color: var(--text-dim); }

/* â”€â”€ GRADE COMPARISON MATRIX â”€â”€ */
.grade-matrix { overflow-x: auto; }
.gm-table { width: 100%; border-collapse: collapse; min-width: 700px; }
.gm-table th {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-dim);
  padding: 0 12px 14px;
  text-align: center;
  border-bottom: 2px solid var(--rule);
}
.gm-table th:first-child { text-align: left; }
.gm-table td {
  padding: 10px 12px;
  text-align: center;
  border-bottom: 1px solid var(--rule2);
  font-size: 13px;
  position: relative;
}
.gm-table td:first-child { text-align: left; font-weight: 700; font-size: 13px; }
.gm-table tr:last-child td { border-bottom: none; }
.gm-table tbody tr { transition: background 0.15s; cursor: pointer; }
.gm-table tbody tr:hover { background: var(--paper2); }
.score-cell {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 44px; height: 28px;
  border-radius: 6px;
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  font-weight: 500;
}
.grade-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 700;
}
.overall-cell {
  font-family: 'DM Mono', monospace;
  font-size: 16px;
  font-weight: 500;
}
.band-indicator {
  display: inline-block;
  width: 8px; height: 8px;
  border-radius: 50%;
  margin-right: 6px;
}

/* â”€â”€ CONCERN HEATMAP BY AGE â”€â”€ */
.age-heatmap { overflow-x: auto; }
.ahm-wrap { min-width: 560px; }
.ahm-row { display: grid; gap: 3px; align-items: center; margin-bottom: 3px; }
.ahm-label { font-size: 12px; color: var(--text-mid); font-weight: 600; }
.ahm-cell {
  height: 36px;
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: transform 0.15s;
  color: white;
}
.ahm-cell:hover { transform: scale(1.05); z-index: 5; position: relative; }

/* â”€â”€ TOP CONCERN PARAMS â”€â”€ */
.concern-spotlight {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 16px;
  margin-bottom: 28px;
}
.spotlight-card {
  background: white;
  border: 1px solid var(--rule);
  border-radius: 16px;
  padding: 22px;
  position: relative;
  overflow: hidden;
}
.spotlight-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 4px;
}
.sp-label { font-size: 10px; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; color: var(--text-dim); margin-bottom: 8px; }
.sp-param { font-size: 18px; font-weight: 800; margin-bottom: 4px; }
.sp-score { font-family: 'DM Mono', monospace; font-size: 36px; font-weight: 500; line-height: 1; margin-bottom: 8px; }
.sp-note { font-size: 12px; color: var(--text-mid); line-height: 1.5; }
.sp-affected {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--rule2);
  font-size: 11px;
  color: var(--text-dim);
}
.sp-affected strong { color: var(--text-mid); }

/* â”€â”€ TREND LINES â”€â”€ */
.trend-chart { position: relative; }

/* â”€â”€ ACTION PLAN â”€â”€ */
.action-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.action-item {
  display: flex;
  gap: 12px;
  padding: 16px;
  border-radius: 12px;
  border: 1px solid var(--rule);
  background: var(--paper);
  align-items: flex-start;
}
.action-number {
  width: 28px; height: 28px;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px;
  font-weight: 900;
  flex-shrink: 0;
  color: white;
}
.action-title { font-size: 13px; font-weight: 800; margin-bottom: 3px; }
.action-text { font-size: 12px; color: var(--text-mid); line-height: 1.5; }
.action-tag {
  display: inline-block;
  font-size: 10px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 4px;
  margin-top: 6px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* â”€â”€ INSIGHT TICKER â”€â”€ */
.insight-bar {
  background: var(--ink);
  color: white;
  padding: 12px 40px;
  display: flex;
  align-items: center;
  gap: 20px;
  overflow: hidden;
  font-size: 12px;
  font-weight: 600;
}
.insight-bar-label {
  background: var(--gold);
  color: var(--ink);
  padding: 3px 12px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 900;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  white-space: nowrap;
  flex-shrink: 0;
}
.insights-scroll {
  display: flex;
  gap: 40px;
  animation: scrollTicker 30s linear infinite;
  white-space: nowrap;
}
.insight-tick { color: rgba(255,255,255,0.7); }
.insight-tick strong { color: white; }
@keyframes scrollTicker {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}

/* â”€â”€ TOOLTIP â”€â”€ */
#tt {
  position: fixed;
  background: var(--ink);
  color: white;
  padding: 8px 14px;
  border-radius: 10px;
  font-size: 12px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.15s;
  z-index: 9999;
  line-height: 1.5;
  max-width: 200px;
}

/* â”€â”€ ANIMS â”€â”€ */
@keyframes fadeUp { from { opacity:0;transform:translateY(20px) } to { opacity:1;transform:translateY(0) } }
.fu { animation: fadeUp 0.6s ease both; }
.fu1 { animation-delay: 0.05s; }
.fu2 { animation-delay: 0.1s; }
.fu3 { animation-delay: 0.15s; }
.fu4 { animation-delay: 0.2s; }
.fu5 { animation-delay: 0.25s; }

/* â”€â”€ RESPONSIVE â”€â”€ */
@media (max-width: 1000px) { .age-bands { grid-template-columns:1fr; } .g2,.g3,.g4 { grid-template-columns:1fr; } }
@media (max-width: 700px) { .content-wrap { padding: 20px; } .hero-strip { padding: 20px; } .hero-kpis { flex-wrap:wrap; } .concern-spotlight { grid-template-columns:1fr; } .action-grid { grid-template-columns:1fr; } }

::-webkit-scrollbar { width:5px;height:5px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:var(--rule); border-radius:3px; }
</style>
</head>
<body>
<div id="tt"></div>

<!-- â”€â”€ MASTHEAD â”€â”€ -->
<header class="masthead">
  <div class="masthead-inner">
    <div class="masthead-brand">
      <div class="brand-emblem">ğŸŒ±</div>
      <div>
        <div class="brand-name-main">WellBeing Analytics</div>
        <div class="brand-name-sub">Annual Evaluation 2024â€“25</div>
      </div>
    </div>
    <nav class="masthead-nav">
      <div class="mnav-item active"><span class="mn-icon">ğŸ«</span> School View</div>
      <div class="mnav-item"><span class="mn-icon">ğŸ“‹</span> Grade View</div>
      <div class="mnav-item"><span class="mn-icon">ğŸ‘¤</span> Individual</div>
    </nav>
    <div class="masthead-right">
      <button class="mhead-btn mhead-btn-outline">Last Year â†—</button>
      <button class="mhead-btn mhead-btn-fill">â¬‡ Export Report</button>
    </div>
  </div>
</header>

<!-- â”€â”€ INSIGHT TICKER â”€â”€ -->
<div class="insight-bar">
  <div class="insight-bar-label">Live Insights</div>
  <div class="insights-scroll" id="tickerContent"></div>
</div>

<!-- â”€â”€ HERO STRIP â”€â”€ -->
<div class="hero-strip">
  <div class="hero-inner">
    <div class="hero-left">
      <h1>Springdale Academy<br><em>School-Wide Wellbeing Report</em></h1>
      <div class="hero-meta">
        <span>ğŸ“… Evaluation Period: Janâ€“Feb 2025</span>
        <span>ğŸ‘©â€ğŸ« Principal: Dr. Sunita Rao</span>
        <span>ğŸ“‹ 450 students across 9 grades</span>
        <span>âœ… 97.8% response rate</span>
      </div>
    </div>
    <div class="hero-kpis" id="heroKpis"></div>
  </div>
</div>

<!-- â”€â”€ CONTENT â”€â”€ -->
<div class="content-wrap">

  <!-- SECTION: Age Group Bands -->
  <div class="section-head fu fu1">
    <div class="section-title">Age Group Analysis<span>Wellbeing by School Stage</span></div>
    <div class="section-action">View detailed breakdown â†’</div>
  </div>
  <div class="age-bands fu fu2" id="ageBands"></div>

  <!-- SECTION: Parameter Overview -->
  <div class="section-head fu fu2">
    <div class="section-title">Parameter Performance<span>All 7 Wellbeing Dimensions</span></div>
    <div class="section-action">Compare with national avg â†’</div>
  </div>
  <div class="g2 fu fu3">
    <div class="card" style="grid-column:span 2">
      <div class="card-title">School-Wide Parameter Scores</div>
      <div class="card-sub">Score out of 100 Â· â–³ = year-on-year change Â· Students in concern zone (&lt;55)</div>
      <div class="param-overview" id="paramOverview"></div>
    </div>
  </div>

  <!-- SECTION: Concern Spotlight -->
  <div class="section-head fu fu3">
    <div class="section-title">Attention Areas<span>Parameters Requiring School Action</span></div>
  </div>
  <div class="concern-spotlight fu fu3" id="concernSpotlight"></div>

  <!-- SECTION: Grade Matrix -->
  <div class="section-head fu fu3">
    <div class="section-title">Grade Comparison<span>All Grades Ã— All Parameters</span></div>
    <div class="section-action">Click grade to open grade view â†’</div>
  </div>
  <div class="card gfull fu fu4">
    <div class="card-title">Cross-Grade Wellbeing Matrix</div>
    <div class="card-sub">Each cell = grade average on that parameter Â· Color intensity = performance Â· Click any grade row to drill down</div>
    <div class="grade-matrix">
      <table class="gm-table" id="gradeMatrix"></table>
    </div>

    <!-- Legend -->
    <div style="display:flex;gap:24px;margin-top:20px;padding-top:16px;border-top:1px solid var(--rule2);flex-wrap:wrap;">
      <div style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-mid)">
        <div style="width:32px;height:14px;border-radius:3px;background:#C8EDD8"></div> Strong (75â€“100)
      </div>
      <div style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-mid)">
        <div style="width:32px;height:14px;border-radius:3px;background:#FEF2CE"></div> Moderate (60â€“74)
      </div>
      <div style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-mid)">
        <div style="width:32px;height:14px;border-radius:3px;background:#FCE0DC"></div> Concern (45â€“59)
      </div>
      <div style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-mid)">
        <div style="width:32px;height:14px;border-radius:3px;background:#F4B8B1"></div> Critical (&lt;45)
      </div>
      <div style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-mid);margin-left:auto;">
        <span style="font-family:'DM Mono',monospace;font-size:14px;color:var(--accent2)">â– </span> Primary
        <span style="font-family:'DM Mono',monospace;font-size:14px;color:var(--green)">â– </span> Middle
        <span style="font-family:'DM Mono',monospace;font-size:14px;color:#7A2E4A">â– </span> Senior
      </div>
    </div>
  </div>

  <!-- SECTION: Age Ã— Param Heatmap -->
  <div class="section-head fu fu4">
    <div class="section-title">Age Group Ã— Parameter<span>Wellbeing Heatmap by Stage</span></div>
  </div>
  <div class="card gfull fu fu4">
    <div class="card-title">Age Group Wellbeing Heatmap</div>
    <div class="card-sub">How each age band performs across every wellbeing parameter</div>
    <div class="age-heatmap">
      <div class="ahm-wrap" id="ageHeatmap"></div>
    </div>
  </div>

  <!-- SECTION: Trend + Action -->
  <div class="g2 fu fu5">
    <!-- Trend -->
    <div class="card">
      <div class="card-title">Year-on-Year Trend</div>
      <div class="card-sub">School-wide parameter movement vs last year</div>
      <svg id="trendSvg" width="100%" height="220" viewBox="0 0 420 220" style="overflow:visible"></svg>
      <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:12px;padding-top:12px;border-top:1px solid var(--rule2);" id="trendLegend"></div>
    </div>

    <!-- Action Plan -->
    <div class="card">
      <div class="card-title">ğŸ“‹ School Action Plan</div>
      <div class="card-sub">Priority interventions based on school-wide data patterns</div>
      <div class="action-grid" id="actionGrid"></div>
    </div>
  </div>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PARAMS = [
  { id:'emotional',   name:'Emotional',   icon:'ğŸ’›', color:'#E8654A' },
  { id:'behavioral',  name:'Behavioral',  icon:'ğŸ¤', color:'#2E86C1' },
  { id:'physical',    name:'Physical',    icon:'ğŸƒ', color:'#1E8449' },
  { id:'academic',    name:'Academic',    icon:'ğŸ“š', color:'#8E44AD' },
  { id:'nutritional', name:'Nutritional', icon:'ğŸ¥—', color:'#D4870A' },
  { id:'digital',     name:'Digital',     icon:'ğŸ“±', color:'#C0392B' },
  { id:'safety',      name:'Safety',      icon:'ğŸ›¡ï¸', color:'#148F77' },
];

// School-wide scores + trend
const SCHOOL = {
  emotional:   { score:70, lastYear:66, concern:82  },
  behavioral:  { score:75, lastYear:72, concern:54  },
  physical:    { score:64, lastYear:67, concern:98  },
  academic:    { score:72, lastYear:69, concern:71  },
  nutritional: { score:60, lastYear:58, concern:112 },
  digital:     { score:46, lastYear:52, concern:168 },
  safety:      { score:83, lastYear:81, concern:38  },
};

// Age Groups
const AGE_GROUPS = [
  {
    id: 'primary', name: 'Primary', grades: 'Grades 1â€“4',
    ages: '6â€“10 yrs', students: 180, color: '#2E4A7A', emoji: 'ğŸ’',
    score: 74,
    delta: +3, deltaDir: 'up',
    scores: { emotional:78, behavioral:80, physical:72, academic:70, nutritional:65, digital:58, safety:87 }
  },
  {
    id: 'middle', name: 'Middle School', grades: 'Grades 5â€“8',
    ages: '11â€“14 yrs', students: 178, color: '#1A6B45', emoji: 'ğŸ“',
    score: 66,
    delta: +2, deltaDir: 'up',
    scores: { emotional:68, behavioral:72, physical:64, academic:74, nutritional:60, digital:44, safety:82 }
  },
  {
    id: 'senior', name: 'Senior School', grades: 'Grades 9â€“12',
    ages: '15â€“18 yrs', students: 175, color: '#7A2E4A', emoji: 'ğŸ“',
    score: 61,
    delta: -1, deltaDir: 'down',
    scores: { emotional:63, behavioral:70, physical:56, academic:72, nutritional:54, digital:38, safety:78 }
  },
];

// All grades
const GRADES = [
  { grade:'Grade 1', band:'primary', students:45, scores:{emotional:82,behavioral:84,physical:76,academic:68,nutritional:68,digital:64,safety:90} },
  { grade:'Grade 2', band:'primary', students:44, scores:{emotional:80,behavioral:82,physical:74,academic:70,nutritional:66,digital:60,safety:88} },
  { grade:'Grade 3', band:'primary', students:46, scores:{emotional:76,behavioral:78,physical:70,academic:72,nutritional:64,digital:55,safety:86} },
  { grade:'Grade 4', band:'primary', students:45, scores:{emotional:74,behavioral:76,physical:68,academic:70,nutritional:62,digital:52,safety:84} },
  { grade:'Grade 5', band:'middle',  students:46, scores:{emotional:72,behavioral:74,physical:66,academic:74,nutritional:62,digital:50,safety:84} },
  { grade:'Grade 6', band:'middle',  students:44, scores:{emotional:70,behavioral:72,physical:64,academic:74,nutritional:60,digital:46,safety:82} },
  { grade:'Grade 7', band:'middle',  students:45, scores:{emotional:66,behavioral:70,physical:62,academic:74,nutritional:58,digital:42,safety:82} },
  { grade:'Grade 8', band:'middle',  students:43, scores:{emotional:64,behavioral:72,physical:64,academic:74,nutritional:60,digital:38,safety:80} },
  { grade:'Grade 9', band:'senior',  students:44, scores:{emotional:66,behavioral:72,physical:60,academic:74,nutritional:56,digital:40,safety:80} },
  { grade:'Grade 10',band:'senior',  students:45, scores:{emotional:64,behavioral:70,physical:58,academic:72,nutritional:54,digital:38,safety:78} },
  { grade:'Grade 11',band:'senior',  students:43, scores:{emotional:62,behavioral:68,physical:54,academic:72,nutritional:54,digital:36,safety:76} },
  { grade:'Grade 12',band:'senior',  students:43, scores:{emotional:60,behavioral:70,physical:52,academic:70,nutritional:52,digital:38,safety:78} },
];

GRADES.forEach(g => {
  g.overall = Math.round(Object.values(g.scores).reduce((a,b)=>a+b,0) / 7);
});

const schoolOverall = Math.round(Object.values(SCHOOL).reduce((s,v)=>s+v.score, 0) / 7);

const BAND_COLORS = { primary:'#2E4A7A', middle:'#1A6B45', senior:'#7A2E4A' };

// Score â†’ cell color
function scoreColor(s) {
  if (s >= 75) return { bg:'#C8EDD8', text:'#1A5C35' };
  if (s >= 60) return { bg:'#FEF2CE', text:'#7A4A00' };
  if (s >= 45) return { bg:'#FCE0DC', text:'#8C2515' };
  return { bg:'#F4B8B1', text:'#6C0E05' };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HERO KPIS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const heroData = [
  { val:schoolOverall, label:'School Wellbeing Index', color:'#7FD4A8' },
  { val:450, label:'Total Students', color:'white' },
  { val:'97.8%', label:'Response Rate', color:'white' },
  { val: GRADES.filter(g=>g.overall<55).length, label:'Grades Needing Focus', color:'#FFAAAA' },
];
const heroEl = document.getElementById('heroKpis');
heroData.forEach(d => {
  heroEl.innerHTML += `<div class="hero-kpi">
    <div class="hk-val" style="color:${d.color}">${d.val}</div>
    <div class="hk-label">${d.label}</div>
  </div>`;
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TICKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ticks = [
  'ğŸ“± <strong>Digital Wellbeing (46)</strong> is the lowest school parameter â€” 168 students in concern zone',
  'ğŸ“ˆ <strong>Behavioral Wellbeing</strong> improved most this year (+3 pts)',
  'ğŸƒ <strong>Physical Wellbeing</strong> declining â€” down 3 pts from last year',
  'ğŸ“ <strong>Senior School</strong> scores lowest overall (61/100)',
  'ğŸ’ <strong>Primary School</strong> scores highest overall (74/100)',
  'ğŸš¨ <strong>Digital concern</strong> worsens with age: Primary 58 â†’ Senior 38',
  'ğŸ¥— <strong>Nutritional scores</strong> below 55 for 112 students across all grades',
];
const doubled = [...ticks, ...ticks];
document.getElementById('tickerContent').innerHTML = doubled.map(t => `<span class="insight-tick">${t}</span>`).join('');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AGE BAND CARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const bandsEl = document.getElementById('ageBands');
AGE_GROUPS.forEach(ag => {
  const deltaColor = ag.deltaDir === 'up' ? '#1E8449' : '#C0392B';
  const deltaBg = ag.deltaDir === 'up' ? 'rgba(30,132,73,0.1)' : 'rgba(192,57,43,0.1)';
  const deltaIcon = ag.deltaDir === 'up' ? 'â–²' : 'â–¼';

  const paramRows = PARAMS.map(p => {
    const s = ag.scores[p.id];
    return `<div class="bp-row">
      <div class="bp-name">${p.icon} ${p.name.slice(0,8)}</div>
      <div class="bp-track"><div class="bp-fill" data-w="${s}" style="background:${p.color}"></div></div>
      <div class="bp-val">${s}</div>
    </div>`;
  }).join('');

  bandsEl.innerHTML += `<div class="age-band-card">
    <div class="band-header" style="background:${ag.color}" data-emoji="${ag.emoji}">
      <div class="band-label">${ag.ages} Â· ${ag.students} students</div>
      <div class="band-name">${ag.name}</div>
      <div class="band-grades">${ag.grades}</div>
    </div>
    <div class="band-body">
      <div class="band-score-row">
        <div class="band-score" style="color:${ag.color}">${ag.score}</div>
        <div class="band-score-label">/100 overall</div>
      </div>
      <div class="band-delta" style="background:${deltaBg};color:${deltaColor}">${deltaIcon} ${Math.abs(ag.delta)} pts vs last year</div>
      <div class="band-params">${paramRows}</div>
    </div>
  </div>`;
});

setTimeout(() => {
  document.querySelectorAll('.bp-fill').forEach(b => { b.style.width = b.dataset.w + '%'; });
}, 400);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARAM OVERVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const poEl = document.getElementById('paramOverview');
PARAMS.forEach(p => {
  const d = SCHOOL[p.id];
  const trend = d.score - d.lastYear;
  const trendStr = (trend>=0?'+':'')+trend;
  const trendClass = trend > 0 ? 'trend-up' : trend < 0 ? 'trend-dn' : 'trend-flat';
  const trendIcon = trend > 0 ? 'â–²' : trend < 0 ? 'â–¼' : 'â€”';
  poEl.innerHTML += `<div class="po-row">
    <div class="po-icon-name"><span class="po-icon">${p.icon}</span>${p.name}</div>
    <div class="po-score">${d.score}</div>
    <div class="po-bar-track">
      <div class="po-bar" data-w="${d.score}" style="background:${p.color}" data-school="${d.score}"></div>
    </div>
    <div class="po-students" style="color:${d.concern>100?'var(--red)':'var(--text-dim)'}">âš  ${d.concern}</div>
    <div class="po-trend ${trendClass}">${trendIcon} ${trendStr}</div>
  </div>`;
});
setTimeout(() => {
  document.querySelectorAll('.po-bar').forEach(b => { b.style.width = b.dataset.w + '%'; });
}, 500);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONCERN SPOTLIGHT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const worstParams = [...PARAMS].sort((a,b) => SCHOOL[a.id].score - SCHOOL[b.id].score).slice(0,3);
const bestParam = [...PARAMS].sort((a,b) => SCHOOL[b.id].score - SCHOOL[a.id].score)[0];

const spotlightEl = document.getElementById('concernSpotlight');
const spotData = [
  { label:'âš  Most Critical', param: worstParams[0], accent:'#C0392B', msg:'Requires immediate school-wide intervention program.' },
  { label:'âš¡ Needs Attention', param: worstParams[1], accent:'#D4870A', msg:'Targeted workshops recommended for Grades 5â€“12.' },
  { label:'âœ… School Strength', param: bestParam, accent:'#1E8449', msg:'Continue current practices and use as a model.' },
];
spotData.forEach(s => {
  const d = SCHOOL[s.param.id];
  spotlightEl.innerHTML += `<div class="spotlight-card">
    <div style="background:${s.accent}" class="spotlight-card" id="sp-top"></div>
    <div style="position:absolute;top:0;left:0;right:0;height:4px;background:${s.accent};border-radius:16px 16px 0 0"></div>
    <div class="sp-label" style="color:${s.accent}">${s.label}</div>
    <div class="sp-param">${s.param.icon} ${s.param.name} Wellbeing</div>
    <div class="sp-score" style="color:${s.accent}">${d.score}</div>
    <div class="sp-note">${s.msg}</div>
    <div class="sp-affected">
      <strong>${d.concern} students</strong> currently in concern zone (score &lt;55)
    </div>
  </div>`;
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GRADE MATRIX
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const gmEl = document.getElementById('gradeMatrix');
let thead = '<thead><tr><th>Grade</th><th>Band</th>';
PARAMS.forEach(p => { thead += `<th>${p.icon} ${p.name.slice(0,5)}</th>`; });
thead += '<th>Overall</th></tr></thead>';
gmEl.innerHTML = thead;

const tbody = document.createElement('tbody');
GRADES.forEach(g => {
  const bandColor = BAND_COLORS[g.band];
  const bandName = { primary:'Primary', middle:'Middle', senior:'Senior' }[g.band];
  const tr = document.createElement('tr');
  let cells = `<td><strong>${g.grade}</strong><div style="font-size:10px;color:var(--text-dim);font-weight:400">${g.students} students</div></td>`;
  cells += `<td><span class="grade-pill" style="background:${bandColor}22;color:${bandColor}">
    <span class="band-indicator" style="background:${bandColor}"></span>${bandName}
  </span></td>`;
  PARAMS.forEach(p => {
    const s = g.scores[p.id];
    const c = scoreColor(s);
    cells += `<td>
      <div class="score-cell" style="background:${c.bg};color:${c.text}"
        onmouseenter="showTip(event,'${g.grade} Â· ${p.name}: ${s}/100')"
        onmouseleave="hideTip()">${s}</div>
    </td>`;
  });
  const oc = scoreColor(g.overall);
  cells += `<td><div class="overall-cell" style="color:${g.overall>=75?'var(--green)':g.overall>=60?'var(--amber)':'var(--red)'}">${g.overall}</div></td>`;
  tr.innerHTML = cells;
  tbody.appendChild(tr);
});
gmEl.appendChild(tbody);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AGE HEATMAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ahmEl = document.getElementById('ageHeatmap');
const colDef = `100px ${PARAMS.map(()=>'1fr').join(' ')} 70px`;

let ahmHtml = `<div style="display:grid;grid-template-columns:${colDef};gap:4px;margin-bottom:6px;">
  <div class="ahm-label" style="text-align:right;padding-right:8px">Group</div>`;
PARAMS.forEach(p => { ahmHtml += `<div class="ahm-label" style="text-align:center;font-size:11px">${p.icon}<br>${p.name.slice(0,5)}</div>`; });
ahmHtml += `<div class="ahm-label" style="text-align:center">Overall</div></div>`;

AGE_GROUPS.forEach(ag => {
  ahmHtml += `<div style="display:grid;grid-template-columns:${colDef};gap:4px;margin-bottom:4px;align-items:center;">`;
  ahmHtml += `<div style="font-size:12px;font-weight:700;text-align:right;padding-right:10px;color:${ag.color}">${ag.emoji} ${ag.name.replace(' School','')}</div>`;
  PARAMS.forEach(p => {
    const s = ag.scores[p.id];
    const intensity = s / 100;
    // Color from param color with opacity
    ahmHtml += `<div class="ahm-cell"
      style="background:${p.color};opacity:${0.35 + intensity * 0.65};font-size:13px;font-weight:700;color:white;text-shadow:0 1px 3px rgba(0,0,0,0.3)"
      onmouseenter="showTip(event,'${ag.name} Â· ${p.name}: ${s}/100')"
      onmouseleave="hideTip()">${s}</div>`;
  });
  ahmHtml += `<div class="ahm-cell" style="background:${ag.color};color:white;font-size:14px;font-weight:800;border-radius:8px">${ag.score}</div>`;
  ahmHtml += `</div>`;
});

// Also add all grade rows
let sep = `<div style="padding:12px 0 8px;font-size:10px;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-dim)">Grade-level breakdown</div>`;
ahmEl.innerHTML = ahmHtml + sep;

GRADES.forEach(g => {
  let rowHtml = `<div style="display:grid;grid-template-columns:${colDef};gap:4px;margin-bottom:3px;align-items:center;">`;
  rowHtml += `<div style="font-size:11px;font-weight:600;text-align:right;padding-right:10px;color:${BAND_COLORS[g.band]}">${g.grade}</div>`;
  PARAMS.forEach(p => {
    const s = g.scores[p.id];
    const c = scoreColor(s);
    rowHtml += `<div class="ahm-cell"
      style="background:${c.bg};color:${c.text};border:1px solid rgba(0,0,0,0.06);height:28px;font-size:11px"
      onmouseenter="showTip(event,'${g.grade} Â· ${p.name}: ${s}/100')"
      onmouseleave="hideTip()">${s}</div>`;
  });
  const oc = scoreColor(g.overall);
  rowHtml += `<div class="ahm-cell" style="background:${oc.bg};color:${oc.text};height:28px;font-size:12px;font-weight:700;border:1px solid rgba(0,0,0,0.08)">${g.overall}</div>`;
  rowHtml += `</div>`;
  ahmEl.innerHTML += rowHtml;
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TREND CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const tsvg = document.getElementById('trendSvg');
const NS = 'http://www.w3.org/2000/svg';
const W = 420, H = 200, pad = { t:20, r:20, b:30, l:36 };

// Grid lines
[0,25,50,75,100].forEach(v => {
  const y = pad.t + (1 - v/100) * (H - pad.t - pad.b);
  const line = document.createElementNS(NS, 'line');
  line.setAttribute('x1', pad.l); line.setAttribute('x2', W - pad.r);
  line.setAttribute('y1', y); line.setAttribute('y2', y);
  line.setAttribute('stroke', 'rgba(10,12,16,0.07)'); line.setAttribute('stroke-width','1');
  tsvg.appendChild(line);
  const lbl = document.createElementNS(NS, 'text');
  lbl.setAttribute('x', pad.l - 6); lbl.setAttribute('y', y+1);
  lbl.setAttribute('text-anchor','end'); lbl.setAttribute('dominant-baseline','middle');
  lbl.setAttribute('font-size','10'); lbl.setAttribute('fill','#9E9B94');
  lbl.setAttribute('font-family','DM Mono, monospace');
  lbl.textContent = v;
  tsvg.appendChild(lbl);
});

// Year labels
['2022â€“23','2023â€“24','2024â€“25'].forEach((yr,i) => {
  const x = pad.l + (i / 2) * (W - pad.l - pad.r);
  const lbl = document.createElementNS(NS, 'text');
  lbl.setAttribute('x', x); lbl.setAttribute('y', H - 2);
  lbl.setAttribute('text-anchor','middle'); lbl.setAttribute('font-size','10');
  lbl.setAttribute('fill','#9E9B94'); lbl.setAttribute('font-family','DM Mono, monospace');
  lbl.textContent = yr;
  tsvg.appendChild(lbl);
});

// Trend data (3 years)
const TREND_DATA = {
  emotional:   [64, 66, 70],
  behavioral:  [69, 72, 75],
  physical:    [70, 67, 64],
  academic:    [65, 69, 72],
  nutritional: [55, 58, 60],
  digital:     [60, 52, 46],
  safety:      [79, 81, 83],
};

PARAMS.forEach(p => {
  const vals = TREND_DATA[p.id];
  const pts = vals.map((v,i) => {
    const x = pad.l + (i/2)*(W-pad.l-pad.r);
    const y = pad.t + (1-v/100)*(H-pad.t-pad.b);
    return `${x},${y}`;
  }).join(' ');
  const polyline = document.createElementNS(NS, 'polyline');
  polyline.setAttribute('points', pts);
  polyline.setAttribute('fill','none');
  polyline.setAttribute('stroke', p.color);
  polyline.setAttribute('stroke-width','2');
  polyline.setAttribute('stroke-linejoin','round');
  polyline.setAttribute('stroke-linecap','round');
  polyline.style.opacity = '0';
  polyline.style.transition = 'opacity 0.5s ease';
  tsvg.appendChild(polyline);

  // End dot
  const [lastX, lastY] = pts.split(' ').pop().split(',');
  const dot = document.createElementNS(NS, 'circle');
  dot.setAttribute('cx', lastX); dot.setAttribute('cy', lastY); dot.setAttribute('r','4');
  dot.setAttribute('fill', p.color); dot.setAttribute('stroke','white'); dot.setAttribute('stroke-width','1.5');
  tsvg.appendChild(dot);

  setTimeout(() => { polyline.style.opacity = 1; }, 600);
});

// Legend
const tlEl = document.getElementById('trendLegend');
PARAMS.forEach(p => {
  tlEl.innerHTML += `<div style="display:flex;align-items:center;gap:5px;font-size:11px;color:var(--text-mid)">
    <div style="width:16px;height:3px;background:${p.color};border-radius:2px"></div>${p.icon} ${p.name}
  </div>`;
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTION PLAN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const actions = [
  { n:1, color:'#C0392B', bg:'rgba(192,57,43,0.1)', title:'Digital Wellness Drive', text:'Launch school-wide program. Senior school digital score (38) is critical.', tag:'Urgent', tagColor:'#C0392B' },
  { n:2, color:'#D4870A', bg:'rgba(212,135,10,0.1)', title:'Nutritional Overhaul', text:'Review canteen menu and introduce nutrition education in Grades 5â€“10.', tag:'High Priority', tagColor:'#D4870A' },
  { n:3, color:'#1E8449', bg:'rgba(30,132,73,0.1)', title:'Physical Activity Policy', text:'Mandate daily 30-min activity across all grades. Physical scores declining YOY.', tag:'This Term', tagColor:'#1E8449' },
  { n:4, color:'#8E44AD', bg:'rgba(142,68,173,0.1)', title:'Senior Emotional Support', text:'Assign counselor to Grades 9â€“12 emotional wellbeing sessions (score: 61â†’63 goal).', tag:'Ongoing', tagColor:'#8E44AD' },
  { n:5, color:'#2E86C1', bg:'rgba(46,134,193,0.1)', title:'Parent Digital Workshop', text:'Run quarterly parent sessions on screen time management.', tag:'Next Month', tagColor:'#2E86C1' },
  { n:6, color:'#148F77', bg:'rgba(20,143,119,0.1)', title:'Safety Program â€” Scale Up', text:'Safety is a school strength (83). Document and replicate practices to other areas.', tag:'Best Practice', tagColor:'#148F77' },
];

const agEl = document.getElementById('actionGrid');
actions.forEach(a => {
  agEl.innerHTML += `<div class="action-item">
    <div class="action-number" style="background:${a.color}">${a.n}</div>
    <div>
      <div class="action-title">${a.title}</div>
      <div class="action-text">${a.text}</div>
      <div class="action-tag" style="background:${a.bg};color:${a.color}">${a.tag}</div>
    </div>
  </div>`;
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOOLTIP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showTip(e, text) {
  const t = document.getElementById('tt');
  t.textContent = text; t.style.opacity = 1;
  t.style.left = (e.clientX+12)+'px'; t.style.top = (e.clientY-32)+'px';
}
function hideTip() { document.getElementById('tt').style.opacity = 0; }

// Animate param bars
setTimeout(() => {
  document.querySelectorAll('.po-bar').forEach(b => { b.style.width = b.dataset.w+'%'; });
}, 600);
</script>
</body>
</html>
